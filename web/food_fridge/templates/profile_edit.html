{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'src/newfood.css' %}">
{% endblock %}

{% block title %}個人資料{% endblock %}
{% block navbar_title %}個人頁面{% endblock %}
{% block main_class %}h-screen overflow-hidden{% endblock %}
{% block content %}
<form id="profile-form" enctype="multipart/form-data">
    <input type="username" name="username" value="{{ user.username }}">
    <input type="email" name="email" value="{{ user.email }}">
    <input type="file" name="avatar">
    <button type="submit">儲存</button>
</form>
<div id="profile-result"></div>
{% endblock %}
{% block script %}
<script>
document.getElementById('profile-form').onsubmit = async function(e) {
    e.preventDefault();
    const formData = new FormData(this);
    const response = await fetch("{% url 'profile_edit' %}", {  // Use the correct URL name
        method: "POST",
        body: formData
    });
    const data = await response.json();
    if (response.status === 201 && data.redirect_url) {
    window.location.href = data.redirect_url;  // 成功時重定向
} else {
    document.getElementById('profile-result').innerText = JSON.stringify(data, null, 2);
}
};
</script>
{% endblock %}
  