<h2>註冊</h2>
<form id="register-form" enctype="multipart/form-data">
  <input type="text" name="username" placeholder="Username" required>
  <input type="email" name="email" placeholder="Email" required>
  <input type="password" name="password1" placeholder="Password" required>
  <input type="password" name="password2" placeholder="Repeat Password" required>
  <input type="file" name="avatar" accept="image/*">
  <button type="submit">註冊</button>
</form>
<div id="register-result"></div>

<script>
document.getElementById('register-form').onsubmit = async function(e) {
    e.preventDefault();
    const formData = new FormData(this);
    const response = await fetch("{% url 'register' %}", {
        method: "POST",
        body: formData
        // 不要加 Content-Type，瀏覽器會自動處理
    });
    const data = await response.json();
    if (response.status === 201 && data.redirect_url) {
        window.location.href = data.redirect_url;  // 成功時重定向
    } else {
        document.getElementById('register-result').innerText = JSON.stringify(data, null, 2);
    }
};
</script>
